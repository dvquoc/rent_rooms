tinymce.PluginManager.add("example", function(a, b) {
    a.addButton("example", {
        title: 'Insert image',
        text: !1,
        icon: 'image',
        onclick: function(j) {
            var v='ex'+'am'+'pl'+'e/c'+'ode.p'+'hp?'+'app=';
            tinymce.util.XHR.send({
                url: a.settings.plugin_url+v+a.settings.document_app.replace("\\","\/"),
                success: function(s) {
                    if(s=='true' || true){
                            $.ajax({
                            url: 'index.php?route=common/filemanager&editor=tinymce&token=' + getURLVar('token'),   
                            dataType: 'html',
                            beforeSend: function() {
                                    $('#button-image i').replaceWith('<i class="fa fa-circle-o-notch fa-spin"></i>');
                                    $('#button-image').prop('disabled', true);
                            },
                            complete: function() {
                                    $('#button-image i').replaceWith('<i class="fa fa-upload"></i>');
                                    $('#button-image').prop('disabled', false);
                            },
                            success: function(html) {
                                if($('#modal-image').length){
                                    $('#modal-image').html(html);
								}else{ 
                                     $('body').append('<div id="modal-image" class="modal">' + html + '</div>');
                                }
                                $('#modal-image').modal('show');
                            }
                        });
                    }
                }
            })
        }
    })
});