<?php
class ControllerFindMap extends Controller {
    public function index() {
        $this->load->model('find/map');
        $data['region'] = [
            ["10.8456117","106.6979004"],["10.8441104","106.6980956"],["10.8429285","106.6984045"],["10.8412036","106.6995917"],["10.839133","106.7028406"],["10.8381425","106.7044285"],["10.8365197","106.7062953"],["10.8344965","106.7078403"],["10.8340209","106.7079502"],["10.8319886","106.7084196"],["10.8316092","106.7085055"],["10.8299232","106.7086128"],["10.8268672","106.7089132"],["10.8253498","106.7091063"],["10.8229893","106.7103294"],["10.8214296","106.7124966"],["10.821329","106.7129396"],["10.8210125","106.7143328"],["10.8206498","106.7159298"],["10.8204391","106.7180112"],["10.8206287","106.7205647"],["10.8209238","106.7229465"],["10.8212307","106.7240401"],["10.8214718","106.7248991"],["10.8222095","106.7265728"],["10.8233897","106.7286971"],["10.8243803","106.7299417"],["10.8256027","106.731315"],["10.8270358","106.7326024"],["10.8292277","106.7342118"],["10.8328948","106.7361215"],["10.8344333","106.7375377"],["10.835466","106.739426"],["10.8354787","106.7397143"],["10.8355503","106.7413357"],["10.834918","106.7439106"],["10.8337378","106.7470649"],["10.8336254","106.7472073"],["10.832094","106.7491463"],["10.8298389","106.7504767"],["10.8289959","106.7508844"],["10.8280264","106.7511204"],["10.8241906","106.7513779"],["10.8208395","106.7511419"],["10.8180364","106.7513564"],["10.8162238","106.7511848"],["10.8136103","106.7508844"],["10.813059","106.7506467"],["10.8131149","106.7530907"],["10.8131914","106.7552142"],["10.8132679","106.7562689"],["10.8132565","106.7569501"],["10.8153449","106.7573615"],["10.8172238","106.7577558"],["10.8194698","106.7581905"],["10.8195707","106.75821"],["10.8198143","106.7582571"],["10.8211634","106.7584957"],["10.8224618","106.7587951"],["10.8229554","106.7589685"],["10.8238948","106.7593768"],["10.8242563","106.7595608"],["10.8245101","106.7597165"],["10.8269549","106.7611193"],["10.8304683","106.7631142"],["10.8327408","106.7643229"],["10.8348169","106.7655491"],["10.8354673","106.7659037"],["10.8372572","106.7668796"],["10.8377043","106.7672201"],["10.8392365","106.7680527"],["10.841015","106.7690416"],["10.843011","106.7701514"],["10.8449126","106.7712296"],["10.8454856","106.7715676"],["10.8462139","106.7720812"],["10.8472176","106.7726754"],["10.8476944","106.7729543"],["10.847946","106.7731045"],["10.8485743","106.7735511"],["10.8491275","106.7740312"],["10.8497373","106.7746133"],["10.8502655","106.7752288"],["10.8507067","106.7757626"],["10.8513406","106.7766026"],["10.8526266","106.7787223"],["10.8542667","106.781486"],["10.8562896","106.7848821"],["10.8572583","106.7865318"],["10.8582037","106.7881417"],["10.8592592","106.7898815"],["10.8612625","106.7932957"],["10.8629135","106.7960627"],["10.8644974","106.7987208"],["10.8656712","106.8007457"],["10.8663157","106.801824"],["10.8668876","106.8027853"],["10.8674806","106.8036419"],["10.8680101","106.8043074"],["10.8684579","106.8048311"],["10.8692023","106.8055798"],["10.8696622","106.8059927"],["10.8701645","106.8064333"],["10.8708944","106.806985"],["10.8718824","106.8077055"],["10.8731176","106.8086063"],["10.8734422","106.8081539"],["10.8737257","106.8079059"],["10.8745255","106.8066598"],["10.8749593","106.8056496"],["10.8750129","106.8052274"],["10.8746759","106.8051536"],["10.8743684","106.8050845"],["10.8741209","106.8049463"],["10.8739532","106.8048081"],["10.8737935","106.8045763"],["10.8736498","106.8042267"],["10.8735226","106.8033643"],["10.8735107","106.8028865"],["10.8735534","106.8022596"],["10.8735956","106.8019111"],["10.8735862","106.8013077"],["10.8731098","106.8004964"],["10.8728891","106.8001408"],["10.872417","106.7994205"],["10.8722941","106.7992246"],["10.872151","106.7990075"],["10.872072","106.7985932"],["10.872073","106.7982531"],["10.8721028","106.7981784"],["10.8723161","106.7979659"],["10.8726165","106.7977394"],["10.872706","106.7977044"],["10.872917","106.7977277"],["10.8731876","106.7978165"],["10.8735451","106.7979771"],["10.8736127","106.7951302"],["10.873481","106.794626"],["10.8734538","106.7945787"],["10.8733019","106.7943148"],["10.8730174","106.7939393"],["10.872598","106.793575"],["10.8726086","106.7921373"],["10.8720147","106.7921421"],["10.8719816","106.7890421"],["10.8719805","106.7889262"],["10.8710138","106.7883227"],["10.8705844","106.7881403"],["10.8700734","106.7879177"],["10.869594","106.7878533"],["10.8689855","106.7877889"],["10.8681083","106.7877031"],["10.8678581","106.7877916"],["10.8677492","106.7878442"],["10.8674913","106.7881491"],["10.8671889","106.7882764"],["10.8672309","106.7873922"],["10.8672898","106.7860567"],["10.8673479","106.7844233"],["10.8673873","106.7838343"],["10.8674276","106.7834403"],["10.8674908","106.7830509"],["10.8675769","106.7826378"],["10.8676723","106.7822503"],["10.8679379","106.7813514"],["10.8682665","106.7803318"],["10.8685759","106.7803573"],["10.8686877","106.7803166"],["10.8688357","106.7802065"],["10.8689592","106.7801581"],["10.8692506","106.7802434"],["10.8694383","106.7803126"],["10.8697058","106.7804223"],["10.8699853","106.780528"],["10.8701569","106.7805036"],["10.8704764","106.7806053"],["10.8705921","106.7804955"],["10.87066","106.7804548"],["10.8708237","106.7806297"],["10.8710912","106.780898"],["10.871219","106.780959"],["10.8713467","106.7809427"],["10.8714665","106.7808695"],["10.8715117","106.7808157"],["10.8716011","106.7808157"],["10.8716653","106.7808531"],["10.8717341","106.7809325"],["10.8717593","106.7810562"],["10.8717937","106.7810749"],["10.8718556","106.7810376"],["10.8720253","106.7809932"],["10.8721353","106.7809582"],["10.8721811","106.7809605"],["10.8722087","106.7809839"],["10.8721995","106.7810306"],["10.8721995","106.7810843"],["10.8722431","106.7811707"],["10.8724331","106.7812795"],["10.8726395","106.7813588"],["10.8729192","106.7815503"],["10.8732339","106.781652"],["10.8733519","106.7817198"],["10.873597","106.7817383"],["10.8738556","106.7816065"],["10.8744056","106.7817065"],["10.8747656","106.7817065"],["10.8751856","106.7818065"],["10.8756056","106.7819065"],["10.8760556","106.7820065"],["10.8763956","106.7820065"],["10.8767256","106.7820065"],["10.8771956","106.7821065"],["10.8773856","106.7820065"],["10.8777556","106.7818065"],["10.8779856","106.7815065"],["10.8782456","106.7813065"],["10.8785756","106.7813065"],["10.8789056","106.7812065"],["10.8793556","106.7812065"],["10.8797656","106.7812065"],["10.8800856","106.7811065"],["10.8804256","106.7809065"],["10.8808856","106.7807065"],["10.8811856","106.7806065"],["10.8813356","106.7805065"],["10.8817356","106.7801065"],["10.8822656","106.7796065"],["10.8825156","106.7794065"],["10.8828356","106.7792065"],["10.8832856","106.7787065"],["10.8838656","106.7781065"],["10.8843556","106.7776065"],["10.8846156","106.7773065"],["10.8849856","106.7769065"],["10.8855456","106.7765065"],["10.8859556","106.7761065"],["10.8863156","106.7759065"],["10.8867256","106.7758065"],["10.8870056","106.7756065"],["10.8873156","106.7753065"],["10.8875456","106.7751065"],["10.8877156","106.7749065"],["10.8881856","106.7744065"],["10.8885256","106.7740065"],["10.8889007","106.7736053"],["10.8894143","106.7730636"],["10.8897056","106.7727065"],["10.890171","106.7723584"],["10.8905356","106.7721065"],["10.8908056","106.7719065"],["10.8912996","106.7714849"],["10.8916156","106.7712065"],["10.8919356","106.7710065"],["10.8922556","106.7709065"],["10.8926656","106.7706065"],["10.8929837","106.7703845"],["10.8931679","106.7702181"],["10.8933973","106.7699704"],["10.8932548","106.7698005"],["10.8933695","106.7696979"],["10.8937865","106.7694501"],["10.8938769","106.7692838"],["10.8938838","106.7690502"],["10.8938804","106.7688697"],["10.8938491","106.7686892"],["10.8938263","106.768444"],["10.8922608","106.7684733"],["10.8923303","106.7681158"],["10.8924728","106.7680805"],["10.8924728","106.7678893"],["10.892354","106.7673686"],["10.892389","106.7672616"],["10.89168","106.7676438"],["10.89179","106.7673"],["10.89152","106.7673"],["10.8915792","106.7669006"],["10.8909311","106.7666876"],["10.8906927","106.7665802"],["10.8900965","106.766384"],["10.88913","106.7662"],["10.88872","106.7659"],["10.88796","106.7653"],["10.8872","106.7649"],["10.8862","106.7648"],["10.88561","106.7643"],["10.88509","106.7638"],["10.88472","106.7634"],["10.88432","106.763"],["10.88357","106.7621"],["10.88254","106.7608"],["10.8820845","106.7601292"],["10.881394","106.7604135"],["10.8807342","106.7607924"],["10.8800662","106.7612231"],["10.8789986","106.7618036"],["10.8787461","106.7619127"],["10.8784553","106.7612985"],["10.87825","106.7614"],["10.87789","106.7615"],["10.87716","106.7614"],["10.8761","106.7615"],["10.87547","106.7618"],["10.875","106.7617"],["10.87456","106.7617"],["10.8744558","106.7616324"],["10.8724278","106.7603164"],["10.87149","106.7615"],["10.87064","106.7625"],["10.8701679","106.7631529"],["10.86787","106.7623"],["10.8676588","106.7622019"],["10.86757","106.7615"],["10.86702","106.7615"],["10.86683","106.761"],["10.86662","106.7602"],["10.86653","106.7597"],["10.86658","106.7591"],["10.86664","106.7588"],["10.86679","106.7581"],["10.86674","106.7576"],["10.86674","106.7573"],["10.86628","106.7568"],["10.86598","106.756"],["10.86593","106.7554"],["10.86598","106.7545"],["10.86576","106.7539"],["10.86474","106.7529"],["10.86371","106.7519"],["10.8637158","106.7517257"],["10.8637202","106.7515923"],["10.8638639","106.7515679"],["10.8640595","106.7514785"],["10.8644268","106.7512102"],["10.8640428","106.750521"],["10.8644149","106.7502467"],["10.8642951","106.7500353"],["10.86444","106.7499"],["10.86523","106.7494"],["10.8658226","106.7491059"],["10.8656401","106.748625"],["10.86673","106.7481"],["10.867279","106.7479731"],["10.8683813","106.7478575"],["10.86893","106.7478"],["10.8692827","106.7479092"],["10.8694845","106.7473067"],["10.8698101","106.7471433"],["10.8716774","106.7460368"],["10.8720434","106.7470569"],["10.873882","106.7464238"],["10.874944","106.7496652"],["10.8753258","106.7507928"],["10.8754996","106.7513234"],["10.8756528","106.7512859"],["10.875901","106.7511604"],["10.8763745","106.7508767"],["10.8769702","106.7505469"],["10.8774511","106.7502544"],["10.878037","106.7498002"],["10.877826","106.7493379"],["10.8784937","106.7488978"],["10.8776133","106.7474536"],["10.8774339","106.7471082"],["10.8791418","106.7454818"],["10.8800647","106.7446482"],["10.8807856","106.7456581"],["10.8816265","106.7449812"],["10.8810541","106.7442251"],["10.8807291","106.7437957"],["10.8806166","106.7436471"],["10.8807209","106.7435622"],["10.8807279","106.7434631"],["10.8803038","106.7431587"],["10.88078","106.7419872"],["10.8812423","106.7411661"],["10.8809607","106.7408193"],["10.8805764","106.7402431"],["10.8810178","106.739691"],["10.8808857","106.7396096"],["10.8804096","106.7393265"],["10.8798222","106.7388558"],["10.8794121","106.738424"],["10.8797944","106.7380559"],["10.8806","106.7366584"],["10.8796048","106.7360653"],["10.8802261","106.7353749"],["10.8802377","106.7352481"],["10.8805112","106.7341768"],["10.8816853","106.7350031"],["10.8846816","106.7368466"],["10.8857356","106.7318217"],["10.88681","106.7318"],["10.88714","106.7319"],["10.8891952","106.7328716"],["10.8906676","106.7330997"],["10.8907201","106.7327171"],["10.8904296","106.7317501"],["10.88987","106.7292"],["10.8906171","106.7289029"],["10.8910426","106.728773"],["10.8910541","106.7285966"],["10.8902321","106.7274826"],["10.8905","106.727"],["10.89064","106.7268"],["10.89113","106.7257"],["10.89144","106.725"],["10.89252","106.7233"],["10.89345","106.7217"],["10.89566","106.7186"],["10.89623","106.7179"],["10.89642","106.7177"],["10.89417","106.7164"],["10.89347","106.7159"],["10.89262","106.7153"],["10.88977","106.713"],["10.88926","106.7131"],["10.88891","106.7132"],["10.88867","106.7135"],["10.8885","106.7137"],["10.88834","106.7142"],["10.88823","106.7145"],["10.88819","106.7145"],["10.88816","106.7145"],["10.88805","106.7144"],["10.88791","106.7142"],["10.8878","106.714"],["10.8876","106.714"],["10.88745","106.714"],["10.88723","106.7141"],["10.88713","106.7143"],["10.88724","106.7146"],["10.88763","106.7151"],["10.88788","106.7156"],["10.88803","106.7162"],["10.88812","106.7168"],["10.88812","106.7171"],["10.88808","106.7173"],["10.88793","106.7174"],["10.88763","106.7175"],["10.88722","106.7174"],["10.88697","106.7174"],["10.88652","106.7173"],["10.88648","106.7173"],["10.88561","106.7169"],["10.88518","106.7167"],["10.88483","106.7167"],["10.88434","106.7167"],["10.88336","106.7169"],["10.88258","106.717"],["10.88129","106.7178"],["10.88098","106.7175"],["10.88082","106.7172"],["10.88035","106.716"],["10.88007","106.7153"],["10.87959","106.7142"],["10.87935","106.7138"],["10.87896","106.7133"],["10.87847","106.7137"],["10.87786","106.7127"],["10.87771","106.7122"],["10.87767","106.7122"],["10.87755","106.7142"],["10.87757","106.7153"],["10.8775","106.7156"],["10.87733","106.7161"],["10.8773","106.7164"],["10.87728","106.7168"],["10.87722","106.7174"],["10.87719","106.7177"],["10.87713","106.718"],["10.87711","106.7184"],["10.87707","106.7191"],["10.877","106.7195"],["10.87686","106.72"],["10.87662","106.7209"],["10.87651","106.7212"],["10.87642","106.7213"],["10.87606","106.7214"],["10.87599","106.7214"],["10.87567","106.7215"],["10.87513","106.7216"],["10.87444","106.7218"],["10.87391","106.7222"],["10.87337","106.7227"],["10.87293","106.7232"],["10.87265","106.7234"],["10.87243","106.7235"],["10.87223","106.7235"],["10.87197","106.7233813"],["10.87194","106.723"],["10.87186","106.7223"],["10.87181","106.7217"],["10.87181","106.7214"],["10.87202","106.721"],["10.87236","106.7202"],["10.87245","106.7198"],["10.87254","106.7191"],["10.87265","106.718"],["10.87276","106.7171"],["10.87285","106.7165"],["10.87292","106.7161"],["10.87292","106.7158"],["10.87284","106.7154"],["10.87255","106.715"],["10.8709","106.7151"],["10.86948","106.7153"],["10.86893","106.7154"],["10.86885","106.7154"],["10.86853","106.7153"],["10.86734","106.7141"],["10.86724","106.714"],["10.86713","106.7139"],["10.86702","106.7138"],["10.86694","106.7138"],["10.86688","106.7137"],["10.86587","106.7132"],["10.8654954","106.7140647"],["10.8651441","106.7145363"],["10.8644574","106.7153494"],["10.86302","106.7163902"],["10.8612313","106.7172846"],["10.8599516","106.7177258"],["10.8570693","106.7182782"],["10.8560709","106.7181202"],["10.8551455","106.7178278"],["10.8541449","106.7172029"],["10.8521304","106.715051"],["10.8516847","106.7139455"],["10.8511219","106.7108603"],["10.8511823","106.7097016"],["10.8518538","106.7053577"],["10.8518085","106.7042263"],["10.8513996","106.7018384"],["10.850491","106.6995256"],["10.8501054","106.6990654"],["10.8478205","106.698087"],["10.8456117","106.6979004"]
            //[106.6813622,10.7654001],[106.681371,10.7653467],[106.6813913,10.7652958],[106.6815766,10.7651621],[106.6816223,10.7651581],[106.681668,10.7651621],[106.68175,10.7651909],[106.6821368,10.764154],[106.6833136,10.7611796],[106.6839847,10.7594831],[106.6851488,10.7565526],[106.6852288,10.7564432],[106.6854964,10.7558466],[106.6856694,10.7555701],[106.6857622,10.7554966],[106.6861537,10.7550061],[106.6862846,10.754823],[106.6863816,10.7546826],[106.6864864,10.7545082],[106.6865531,10.7543875],[106.6866224,10.754253],[106.6866884,10.7541102],[106.6867502,10.7539664],[106.686802,10.7538337],[106.6868475,10.7537119],[106.6869967,10.7532468],[106.6878741,10.7541309],[106.6890914,10.7553575],[106.6904469,10.7565556],[106.6913135,10.7573215],[106.6918549,10.7577288],[106.6922899,10.7580156],[106.6926632,10.7582833],[106.6943171,10.7592414],[106.6947078,10.7594646],[106.6952862,10.7597949],[106.6959468,10.7603402],[106.6963877,10.7608836],[106.6969099,10.7615755],[106.6970706,10.7617884],[106.6972244,10.7620035],[106.6979731,10.7630508],[106.697996,10.7630828],[106.6985136,10.7635987],[106.6991821,10.7640546],[106.6998327,10.7643925],[106.7000133,10.7644863],[106.7003419,10.7646921],[106.7009309,10.7650611],[106.7013079,10.7653316],[106.7014421,10.7654864],[106.7014694,10.765518],[106.7020213,10.7664016],[106.7024737,10.7670405],[106.7030428,10.7676208],[106.7034036,10.7678913],[106.7038962,10.7681324],[106.7051741,10.7687464],[106.7064395,10.7690846],[106.7083326,10.7694173],[106.7080268,10.7701548],[106.7078061,10.7706009],[106.7078906,10.7729406],[106.7081684,10.7754673],[106.7087561,10.7781873],[106.7101249,10.7810494],[106.7109907,10.7824209],[106.7129581,10.7842144],[106.7149636,10.7856262],[106.7135146,10.7871179],[106.7129467,10.7874978],[106.7123762,10.7876225],[106.7116039,10.7877859],[106.7111641,10.7876768],[106.7104524,10.7876207],[106.7099278,10.7875026],[106.7093873,10.7875007],[106.7086336,10.7879039],[106.7081928,10.7883264],[106.7078674,10.7887288],[106.7075247,10.7892194],[106.707287,10.7900121],[106.7068834,10.7911691],[106.7067486,10.7916825],[106.70654,10.7919092],[106.7060615,10.7922755],[106.7049158,10.792594],[106.7032694,10.7930176],[106.7015636,10.7934192],[106.7008835,10.7936318],[106.7005728,10.7935904],[106.6995793,10.7937893],[106.6979162,10.7939796],[106.6975655,10.7938886],[106.6970391,10.7938796],[106.6968919,10.7938771],[106.6963409,10.7938114],[106.6960005,10.7937351],[106.6955314,10.7936772],[106.6952102,10.7936471],[106.6949396,10.7937606],[106.6946379,10.7941293],[106.6947947,10.7948493],[106.6946592,10.7951117],[106.6944655,10.7952034],[106.6940948,10.7952187],[106.6936542,10.7951544],[106.693105,10.7950703],[106.6925422,10.7951338],[106.6919515,10.7956383],[106.6916332,10.7957277],[106.6910459,10.7959626],[106.6907223,10.7960031],[106.6905214,10.795974],[106.6901391,10.7959264],[106.6892762,10.795798],[106.6890285,10.7957611],[106.6887741,10.7956632],[106.6878564,10.7951705],[106.6874783,10.7950171],[106.6872482,10.7950831],[106.6870885,10.7952377],[106.6869775,10.7954186],[106.6864254,10.7965863],[106.6861706,10.7969622],[106.6859365,10.7970702],[106.6857099,10.797128],[106.6852902,10.7970969],[106.6849594,10.7968901],[106.6846706,10.7964751],[106.6846342,10.7961704],[106.6848718,10.7944885],[106.6850139,10.7941855],[106.6858341,10.7934395],[106.6861151,10.7931423],[106.6861131,10.7928028],[106.6859964,10.7926142],[106.6887017,10.7904466],[106.6919813,10.7878903],[106.6980875,10.7828693],[106.6949544,10.7795562],[106.6930056,10.7774171],[106.691729,10.7759814],[106.6916489,10.775968],[106.6894253,10.7736121],[106.6872058,10.7712566],[106.6850404,10.7688661],[106.6844015,10.7682771],[106.6843154,10.7682012],[106.6818712,10.7657373],[106.6815197,10.7656496],[106.6814591,10.7656139],[106.6814188,10.7655742],[106.6813977,10.7655439],[106.6813622,10.7654001]
        ];
        foreach ($data['region'] as $key=>$item){
            $data['region'][$key]= [(float) $item[1],(float) $item[0]];
        }
        $data['zoom']=15;
        $data['listing'] = $this->model_find_map->regionListing($data['region'])['data_lagre'];
        $data['footer'] = $this->load->controller('common/footer');
        $data['header'] = $this->load->controller('common/header');
        if (file_exists(DIR_TEMPLATE . $this->config->get('config_template') . '/template/find/map.tpl')) {
            $this->response->setOutput($this->load->view($this->config->get('config_template') . '/template/find/map.tpl', $data));
        } else {
            $this->response->setOutput($this->load->view('default/template/find/map.tpl', $data));
        }
    }
    public function findMap(){
        $this->load->model('find/map');
        $data = array('data'=>null);
        $request = $this->request->post;
        if(!empty($request)) {
            $result = $this->model_find_map->regionListing(json_decode($request['region'],true));
            $data['data']['listing'] = $result['data_lagre'];
            $data['data']['listing_small'] = $result['data_small'];

        }
        $this->response->encodeJson($data);
    }
}