tinymce.PluginManager.add("shortcode", function(a) {
    function b(b) {
        return function() {
            var c = a.settings.link_list;
            "string" == typeof c ? tinymce.util.XHR.send({
                url: c,
                success: function(a) {
                    b(tinymce.util.JSON.parse(a))
                }
            }) : "function" == typeof c ? c(b) : b(c)
        }
    }

    function d(b) {
        function g(b) {
            console.log(b);
        }

        function f(b) {
            console.log(b);
        }
        var bie = function ($obj) {
            $obj.click(function () {
                alert();
            });
            return $obj;
        };


        var i, j, k, l, m, n, o, p, q, r, s, t;
        var u = [{
                name: "search",
                type: "textbox",
                size: 40,
                autofocus: !0,
                label: "TÃ¬m shortcode",
                onchange: g,
                onkeyup: f
            }]
            v = a.selection,
            w = a.dom;
            i = v.getNode(),
            tinymce.util.XHR.send({
                url: "/index.php?route=api/module",
                success: function(s) {
                    var r = JSON.parse(s);
                    $.each(r.data,function (key,item) {
                        console.log(item);
                        var data = {
                            type: 'container',
                            html: "<div data-id-module='"+item.module_id+"' data-code='"+item.code+"' class='item-module'><b>"+item.name+"</b></div>",
                            multiline: true,
                            onclick: function (e) {
                                var im=$(this.$el).find('.item-module').data('id-module');
                                var cd=$(this.$el).find('.item-module').data('code');
                                a.execCommand('mceInsertContent',false,"<code>[module code='"+cd+"']"+im+"[/module]</code>");
                                a.windowManager.close();
                            }
                        }
                        u.push(data);
                    });
                    a.windowManager.open({
                        title: "Shortcode",
                        body: u,
                        width: 600,
                        autoScroll: true,
                        height: 600,
                        
                        onSubmit: function(b) {
                            console.log(b.data);
                        }
                    })
                    return s.data;
                }
            });
    }
    a.addButton("shortcode", {
        title: 'Insert shortcode',
        image: '/image/icon/app.svg',
        onclick: b(d)
    })
});